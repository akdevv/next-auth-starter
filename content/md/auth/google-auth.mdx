---
title: 'Setting Up Google Auth'
description: 'Learn how to set up and configure Google authentication for your Next.js application'
---

# Setting Up Google Auth

## Prerequisites

1. Google Cloud Platform account
2. Next.js project with NextAuth.js installed
3. Environment variables configured

## Step-by-Step Setup

### 1. Create Google Cloud Project

1. Go to [Google Cloud Console](https://console.cloud.google.com)
2. Create a new project or select existing one
3. Enable the Google+ API
4. Configure OAuth consent screen

### 2. Configure OAuth Consent Screen

1. Go to "OAuth consent screen"
2. Select "External" user type
3. Fill in required information:
   - App name
   - User support email
   - Developer contact information
4. Add scopes:
   - `.../auth/userinfo.email`
   - `.../auth/userinfo.profile`

### 3. Create OAuth Credentials

1. Go to "Credentials"
2. Click "Create Credentials"
3. Select "OAuth client ID"
4. Choose "Web application"
5. Add authorized redirect URIs:
   ```
   http://localhost:3000/api/auth/callback/google
   https://your-domain.com/api/auth/callback/google
   ```

### 4. Configure Environment Variables

Add these to your `.env` file:
```env
GOOGLE_CLIENT_ID="your-client-id"
GOOGLE_CLIENT_SECRET="your-client-secret"
```

### 5. Configure NextAuth.js

```typescript
// lib/auth.ts
import GoogleProvider from "next-auth/providers/google";

export const authOptions = {
  providers: [
    GoogleProvider({
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    }),
  ],
  // Additional configuration
};
```

### 6. Add Login Button

```typescript
// components/auth/google-login-button.tsx
import { signIn } from "next-auth/react";

export function GoogleLoginButton() {
  return (
    <button
      onClick={() => signIn("google")}
      className="flex items-center gap-2"
    >
      <GoogleIcon />
      Sign in with Google
    </button>
  );
}
```

## Customization

### 1. Custom Scopes
```typescript
GoogleProvider({
  clientId: process.env.GOOGLE_CLIENT_ID!,
  clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
  authorization: {
    params: {
      scope: "openid email profile https://www.googleapis.com/auth/calendar",
    },
  },
})
```

### 2. Custom Callback
```typescript
GoogleProvider({
  clientId: process.env.GOOGLE_CLIENT_ID!,
  clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
  async profile(profile) {
    return {
      id: profile.sub,
      name: profile.name,
      email: profile.email,
      image: profile.picture,
      // Add custom fields
    };
  },
})
```

## Security Considerations

1. **Client ID and Secret**
   - Keep credentials secure
   - Never expose in client-side code
   - Use environment variables

2. **OAuth Scopes**
   - Request minimum required scopes
   - Review scope usage
   - Document scope requirements

3. **Error Handling**
   - Handle authentication errors
   - Implement proper error messages
   - Log security events

## Troubleshooting

### Common Issues

1. **Invalid Redirect URI**
   - Check authorized redirect URIs
   - Verify domain configuration
   - Check for typos

2. **Scope Issues**
   - Verify required scopes
   - Check OAuth consent screen
   - Review API access

3. **Authentication Errors**
   - Check credentials
   - Verify environment variables
   - Review error logs

## Best Practices

1. **Configuration**
   - Use environment variables
   - Implement proper error handling
   - Follow security guidelines

2. **User Experience**
   - Provide clear error messages
   - Implement loading states
   - Handle edge cases

3. **Security**
   - Implement proper validation
   - Use secure session handling
   - Follow OAuth best practices

## Next Steps

1. Test the authentication flow
2. Implement error handling
3. Add additional providers
4. Customize the user experience

For more detailed information about specific features, refer to the relevant sections in this documentation. 